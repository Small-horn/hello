# 校园公告系统 - 互动功能说明

## 新增功能概述

本次更新为校园公告系统添加了完整的互动功能，包括评论、点赞、回复和收藏功能，大大提升了用户参与度和系统的互动性。

## 功能特性

### 1. 点赞功能
- **公告点赞**：用户可以对公告进行点赞/取消点赞
- **评论点赞**：用户可以对评论进行点赞/取消点赞
- **实时统计**：实时显示点赞数量
- **状态保持**：记录用户点赞状态，避免重复点赞

### 2. 收藏功能
- **公告收藏**：用户可以收藏感兴趣的公告
- **收藏管理**：支持取消收藏
- **收藏统计**：显示公告被收藏的次数
- **个人收藏夹**：用户可以查看自己的收藏列表

### 3. 评论系统
- **发表评论**：用户可以对公告发表评论
- **评论排序**：支持按时间和热度排序
- **评论统计**：显示评论总数
- **评论管理**：支持编辑和删除自己的评论

### 4. 回复功能
- **评论回复**：用户可以回复其他用户的评论
- **嵌套显示**：回复以嵌套形式显示在原评论下方
- **@提及**：回复时显示被回复用户的信息
- **回复统计**：显示每条评论的回复数量

## 数据库设计

### 新增数据表

#### 1. comments 表（评论表）
```sql
- id: 主键ID
- announcement_id: 公告ID（外键）
- user_id: 用户ID（外键）
- parent_id: 父评论ID（用于回复）
- content: 评论内容
- like_count: 点赞数
- reply_count: 回复数
- is_deleted: 是否已删除
- created_at: 创建时间
- updated_at: 更新时间
```

#### 2. likes 表（点赞表）
```sql
- id: 主键ID
- user_id: 用户ID（外键）
- target_type: 目标类型（ANNOUNCEMENT/COMMENT）
- target_id: 目标ID
- created_at: 创建时间
```

#### 3. favorites 表（收藏表）
```sql
- id: 主键ID
- user_id: 用户ID（外键）
- announcement_id: 公告ID（外键）
- created_at: 创建时间
```

### 扩展现有表

#### announcements 表新增字段
```sql
- like_count: 点赞数
- comment_count: 评论数
- favorite_count: 收藏数
```

## API接口

### 评论相关接口
- `POST /api/comments` - 发表评论/回复
- `GET /api/comments/announcement/{id}` - 获取公告评论列表
- `GET /api/comments/{id}/replies` - 获取评论回复列表
- `PUT /api/comments/{id}` - 更新评论
- `DELETE /api/comments/{id}` - 删除评论

### 点赞相关接口
- `POST /api/likes/announcement` - 点赞/取消点赞公告
- `POST /api/likes/comment` - 点赞/取消点赞评论
- `GET /api/likes/announcement/{id}/status` - 获取公告点赞状态
- `GET /api/likes/comment/{id}/status` - 获取评论点赞状态

### 收藏相关接口
- `POST /api/favorites` - 收藏/取消收藏公告
- `GET /api/favorites/status` - 获取收藏状态
- `GET /api/favorites/user/{id}` - 获取用户收藏列表

## 前端实现

### 页面更新
- **公告详情页**：添加了完整的互动功能界面
- **评论区域**：实现了评论发表、显示、回复功能
- **操作按钮**：点赞、收藏按钮的状态切换
- **统计显示**：实时显示各项统计数据

### 样式设计
- **响应式设计**：适配移动端和桌面端
- **交互反馈**：按钮状态变化和动画效果
- **用户体验**：清晰的视觉层次和操作反馈

### JavaScript功能
- **异步操作**：所有互动操作都是异步进行
- **状态管理**：维护用户操作状态
- **错误处理**：完善的错误提示和处理机制

## 使用说明

### 用户操作流程

1. **查看公告**
   - 进入公告详情页面
   - 查看公告内容和统计信息

2. **点赞操作**
   - 点击点赞按钮进行点赞/取消点赞
   - 按钮状态会实时更新

3. **收藏操作**
   - 点击收藏按钮进行收藏/取消收藏
   - 可在个人中心查看收藏列表

4. **发表评论**
   - 在评论输入框中输入内容
   - 点击"发表评论"按钮提交

5. **回复评论**
   - 点击评论下方的"回复"按钮
   - 在弹出的模态框中输入回复内容

6. **评论排序**
   - 选择"最新"或"最热"排序方式
   - 评论列表会重新排序显示

## 技术特点

### 后端技术
- **Spring Boot**：提供RESTful API
- **JPA/Hibernate**：数据持久化
- **MySQL**：数据存储
- **事务管理**：保证数据一致性

### 前端技术
- **jQuery**：DOM操作和AJAX请求
- **CSS3**：现代化样式设计
- **响应式布局**：适配多种设备
- **Font Awesome**：图标库

### 安全考虑
- **用户认证**：所有操作需要登录
- **权限控制**：用户只能操作自己的内容
- **数据验证**：前后端双重验证
- **SQL注入防护**：使用参数化查询

## 部署说明

### Docker部署
系统支持Docker部署，包含：
- **应用容器**：Spring Boot应用
- **数据库容器**：MySQL数据库
- **反向代理**：Nginx配置
- **ARM64支持**：兼容ARM架构服务器

### 数据库初始化
- 自动创建所需表结构
- 插入示例数据
- 设置正确的字符编码（UTF-8）

## 后续扩展

### 可能的功能扩展
1. **通知系统**：评论和回复通知
2. **内容审核**：评论内容过滤
3. **用户等级**：基于互动活跃度的用户等级
4. **热门排行**：基于互动数据的热门公告排行
5. **移动端APP**：原生移动应用开发

### 性能优化
1. **缓存机制**：Redis缓存热门数据
2. **分页优化**：大数据量的分页处理
3. **数据库优化**：索引优化和查询优化
4. **CDN加速**：静态资源加速

## 总结

本次更新成功为校园公告系统添加了完整的互动功能，提升了用户参与度和系统的实用性。通过合理的数据库设计、完善的API接口和友好的用户界面，为用户提供了良好的使用体验。系统具有良好的扩展性，为后续功能开发奠定了坚实基础。
